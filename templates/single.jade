link(rel="import" href="/bower_components/polymer/polymer.html")

dom-module(id="#{name}-single")
  template
    iron-ajax(
      auto="{{params_ready}}"
      id="#{name}-req"
      url="#{api_root}/#{name}/{{id}}"
      headers="{{xhr_headers}}"
      last-response="{{response}}"
    )

    section(class="single #{name}-single")
      ul
        each value, key in attributes
          li.row
            strong= key
            | &nbsp;
            em [[response.data.attributes.#{key}]]
        
  script.
    Polymer({
      is: "#{name}-single",
      
      properties: {
        id: {
          type: String,
          value: null
        },
        params_ready: {
          type: Boolean,
          computed: "_params_ready(id)"
        },
        xhr_headers: {
          type: Object,
          notify: true,
          computed: "_xhr_headers(id)"
        }
      },
      
      _params_ready: function _params_ready(id) {
        return id !== null
      },
      
      _xhr_headers: function get_xhr_headers() {
        return window.app.get("headers")
      }
    })
      
